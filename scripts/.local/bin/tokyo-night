#!/usr/bin/env bash

###########################################
### TOKYO NIGHT THEME SWITCHER        ###
###########################################

# Script para aplicar tema Tokyo Night em v√°rias aplica√ß√µes
# Uso: tokyo-night [app|all]

TOKYO_NIGHT_BG="#1a1b26"
TOKYO_NIGHT_FG="#c0caf5"
TOKYO_NIGHT_BLUE="#7aa2f7"

show_help() {
    cat << EOF
üåÉ Tokyo Night Theme Switcher

Aplica o tema Tokyo Night em v√°rias aplica√ß√µes de forma consistente.

Uso: $(basename "$0") [TARGET]

TARGETS:
    gtk           Aplicar tema GTK (Thunar, etc.)
    terminal      Configurar cores do terminal
    rofi          Recarregar tema do Rofi
    waybar        Recarregar Waybar
    hyprland      Recarregar Hyprland
    all           Aplicar em tudo
    check         Verificar status dos temas
    help          Mostrar esta ajuda

EXEMPLOS:
    $(basename "$0") gtk      # S√≥ GTK
    $(basename "$0") all      # Tudo
    $(basename "$0") check    # Verificar

üé® Paleta Tokyo Night:
  Background: $TOKYO_NIGHT_BG
  Foreground: $TOKYO_NIGHT_FG
  Blue:       $TOKYO_NIGHT_BLUE

EOF
}

apply_gtk() {
    echo "üé® Aplicando tema Tokyo Night no GTK..."
    export GTK_THEME=Tokyonight-Dark
    
    # Aplicar via gsettings tamb√©m
    if command -v gsettings >/dev/null 2>&1; then
        gsettings set org.gnome.desktop.interface gtk-theme 'Tokyonight-Dark' 2>/dev/null || true
        gsettings set org.gnome.desktop.interface color-scheme 'prefer-dark' 2>/dev/null || true
    fi
    
    echo "‚úÖ Tema GTK aplicado!"
}

reload_rofi() {
    echo "üöÄ Verificando tema do Rofi..."
    if [ -f "$HOME/.config/rofi/tokyo-night.rasi" ]; then
        echo "‚úÖ Tema Tokyo Night do Rofi est√° configurado!"
    else
        echo "‚ö†Ô∏è  Tema Tokyo Night do Rofi n√£o encontrado"
    fi
}

reload_waybar() {
    echo "üìä Recarregando Waybar..."
    killall waybar 2>/dev/null
    sleep 1
    waybar &
    echo "‚úÖ Waybar recarregado!"
}

reload_hyprland() {
    echo "üñ•Ô∏è Recarregando Hyprland..."
    hyprctl reload
    echo "‚úÖ Hyprland recarregado!"
}

check_themes() {
    echo "üîç Verificando status dos temas Tokyo Night..."
    echo ""
    
    # GTK Theme
    if [ "$GTK_THEME" = "Tokyonight-Dark" ]; then
        echo "‚úÖ GTK_THEME: $GTK_THEME"
    else
        echo "‚ùå GTK_THEME: ${GTK_THEME:-n√£o definido}"
    fi
    
    # Rofi
    if [ -f "$HOME/.config/rofi/tokyo-night.rasi" ]; then
        echo "‚úÖ Rofi: Tokyo Night theme encontrado"
    else
        echo "‚ùå Rofi: Tokyo Night theme n√£o encontrado"
    fi
    
    # Hyprland
    if pgrep -x "Hyprland" >/dev/null; then
        echo "‚úÖ Hyprland: Rodando"
    else
        echo "‚ùå Hyprland: N√£o est√° rodando"
    fi
    
    # Waybar
    if pgrep -x "waybar" >/dev/null; then
        echo "‚úÖ Waybar: Rodando"
    else
        echo "‚ùå Waybar: N√£o est√° rodando"
    fi
    
    echo ""
    echo "üé® Cores Tokyo Night:"
    echo "  Background: $TOKYO_NIGHT_BG"
    echo "  Foreground: $TOKYO_NIGHT_FG"
    echo "  Blue:       $TOKYO_NIGHT_BLUE"
}

case "$1" in
    "gtk")
        apply_gtk
        ;;
    "rofi")
        reload_rofi
        ;;
    "waybar")
        reload_waybar
        ;;
    "hyprland")
        reload_hyprland
        ;;
    "all")
        echo "üåÉ Aplicando tema Tokyo Night em tudo..."
        apply_gtk
        reload_rofi
        reload_waybar
        reload_hyprland
        echo "‚úÖ Tokyo Night aplicado em todas as aplica√ß√µes!"
        ;;
    "check")
        check_themes
        ;;
    "help"|"-h"|"--help"|"")
        show_help
        ;;
    *)
        echo "‚ùå Target desconhecido: $1"
        echo "üí° Use 'help' para ver targets dispon√≠veis"
        exit 1
        ;;
esac
